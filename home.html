<!DOCTYPE html>
<html>

<head>
    <title>QuickTube</title>
    <link href="styles.css" rel="stylesheet" type="text/css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
</head>

<body onload="loadClient()">
    
    <div class="heading" >
        <div id="logo">
            <img src="quicktubeLogo.png" width="50" height="50" alt="qt"></img>
        </div>
        <div id="search">
            <input type="text" id="keyword">&nbsp</input>
            <button type="button" onclick="execute_Search()" class="btn btn-primary" id="commit">Search</button>
        </div>
        <div class ="right">
            <div id="login">
                <button type="button" class="btn btn-primary" id="signin">Login</button>
            </div>
            
        </div>
    </div>
    <div>Search Result</div>
    <div id="searchResults"></div>
    <div>Most Popular</div>
    <div id="popularResults"></div>
    <script src="https://apis.google.com/js/api.js"></script>


    <script>
        
        function loadClient() {
            gapi.client.setApiKey("AIzaSyBZHX6SuAgh2zbwQ9Og3HFA3m3VaMf-Z2k");
            return gapi.client.load("https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest")
                .then(function() { console.log("GAPI client loaded for API"); },
                    function(err) { console.error("Error loading GAPI client for API", err); });
        }
        
        //var search_vid = [];
        function execute_Search() {
            //search_vid = []
            var $searchQuery = document.getElementById("keyword").value;
            return gapi.client.youtube.search.list({
                    "part": "snippet",
                    "maxResults": 5,
                    "q": $searchQuery
                })
                .then(function(response) {
                        // Handle the results here (response.result has the parsed body).
                        document.getElementById("searchResults").innerHTML += "<br>";
                        console.log(response.result.items);
                        response.result.items.forEach(showURL);
                    },
                    function(err) { console.error("Execute error", err); });
        }
        var num = 0;
        function showURL(item) {
           //search_vid.push("https://youtube.com/embed/" + item.id.videoId); 
             console.log("https://youtube.com/embed/" + item.id.videoId);
             console.log(num);
             $("[id=searchResults]").append(`<div class="col s3">
          <iframe width="100%" height="auto" src="https://www.youtube.com/embed/${item.id.videoId}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><button type="button" class="btn btn-primary mb1 bg-orange" id="add_search_playlist${num++}">Add to playlist</button></div>`);
        }
        num = 0;
        gapi.load("client");
    </script>
    

</body>
<script src="https://apis.google.com/js/api.js"></script>
<script>
//var pop_vid = [];
  function execute_Popular() {
      //pop_vid = [];
    return gapi.client.youtube.videos.list({
      "part": "snippet",
      "chart": "mostPopular",
      "regionCode": "US"
    })
        .then(function(response) {
                // Handle the results here (response.result has the parsed body).
              
                console.log(response.result.items[0].id);
                response.result.items.forEach(showPopular);
              },
              function(err) { console.error("Execute error", err); });
  }
  var count = 0;
  function showPopular(item) {
            //pop_vid.push("https://youtube.com/embed/" + item.id);
             console.log("https://youtube.com/embed/" + item.id);
             console.log(count);
             $("[id=popularResults]").append(`<div class="col s3">
          <iframe width="100%" height="auto" src="https://www.youtube.com/embed/${item.id}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><button type="button" class="btn btn-primary mb1 bg-orange" id="add_pop_playlist${count++}">Add to playlist</button></div>`);
             
        }
        count = 0;
  //gapi.load("client");
</script>
<button onclick="execute_Popular()">Display Popular Video</button>
    


<script>
    $(document).ready(function() {
        $("#login").on('click', function() {
            window.location = "login.html";
        });
    });
</script>
<footer>QuickTube&copy by Antonio, Daichi, Maximillian, and Ricky</footer>

</html>