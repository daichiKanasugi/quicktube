
<!DOCTYPE html>
<html>

<head>
  <title>QuickTube Sign Up</title>
  <link href="styles/signUpStyles.css" rel="stylesheet" type="text/css" />
  <link rel="shortcut icon" href="quicktubeLogo.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
</head>


<body>

  <form style="border:1px solid #ccc">
    <div class="container">
      <h1>Sign Up</h1>
      <p>Please fill in this form to create an account.</p>
      <hr>

      <label for="userName"><b>Username</b></label>
      <input type="text" placeholder="Enter Username" id="usernameInput" name="userName" required>
      <span id="usernameMessage"></span><br>

      <label for="psw"><b>Password</b></label>
      <input type="password" placeholder="Enter Password" name="password" required>

      <label for="psw-repeat"><b>Repeat Password</b></label>
      <input type="password" placeholder="Repeat Password" name="password-repeat" required>

      <label>
      <div id="messages"></div>
    </label>

      <p>By creating an account you agree to our <a href="privacyPolicy.html" style="color:dodgerblue">Terms & Privacy</a>.</p>

      <div class="clearfix">
        <button type="button" class="cancelbtn" id="cancelbtn">Cancel</button>
        <button type="submit" id="signupbtn" class="signupbtn">Sign Up</button>
      </div>
    </div>
  </form>

</body>

<script>
  /* global $ */
  $(document).ready(function() {
    $("#cancelbtn").on('click', function() {
      window.location = "login.html";
    });
    $("#usernameInput").on('change', function() {
      $("#usernameMessage").html(" ");
      $.ajax({
        type: "GET",
        url: "api/usernameCheck.php",
        dataType: "json",
        data: { "username": $("#usernameInput").val() },
        success: function(data, stauts) {
          if (data == false) {
            $("#usernameMessage").html("Username is available").css("color", "green");
          }
          else {
            $("#usernameMessage").html("Username is taken").css("color", "red");
          }
        }
      });
    });
    $("#signupbtn").on('click', function() {
      $("#message").html("");
      console.log($("[name=userName]").val());
      console.log($("[name=password]").val());
      if ($("[name=password]").val() == $("[name=password-repeat]").val()) {
        $.ajax({
          type: "POST",
          url: "api/signUp.php",
          dataType: "json",
          data: {
            "username": $("[name=userName]").val(),
            "password": $("[name=password]").val(),
          },success:function(data,status){
            window.location = "login.html";
          }
        });
      }
      else {
        $("#messages").append("Passwords do not match").css("color", "red");
      }
    });
  });
</script>

</html>